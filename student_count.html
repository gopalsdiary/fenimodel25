<!doctype html>
<html lang="bn">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Student Count Summary</title>
	<link href="https://fonts.maateen.me/kalpurush/font.css" rel="stylesheet">
	<style>
		:root{ color-scheme: light dark; }
		body{ margin:0; font-family:'Kalpurush','Noto Sans Bengali','Hind Siliguri', system-ui, Arial, sans-serif; background:#f6f7f9; color:#0f172a; }
		header{ position:sticky; top:0; background:#fff; border-bottom:1px solid #e5e7eb; z-index:5; }
		.container{ max-width:1100px; margin:0 auto; padding:1rem; }
		h1{ margin:.25rem 0 .5rem; font-size:1.35rem; text-align:center; }
		.muted{ color:#6b7280; font-size:.9rem; }
		.table-wrap{ max-width:1100px; margin:1rem auto; overflow:auto; border-radius:10px; }
		table{ width:100%; border-collapse:collapse; background:#fff; border:1px solid #e5e7eb; min-width:700px; }
	thead th{ background:linear-gradient(90deg,#e3f2fd,#e8f5e9,#fff8e1,#f3e5f5,#e3f2fd); background-size:200% 100%; animation:bg-pan 12s ease-in-out infinite; text-align:left; padding:.65rem .75rem; border-bottom:2px solid #e5e7eb; color:#0f172a; }
	@keyframes bg-pan{ 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
	tbody td{ padding:.6rem .75rem; border-top:1px solid #f1f5f9; transition:background .25s ease, color .25s ease; }
		tfoot td{ padding:.7rem .75rem; font-weight:700; background:#f8fafc; border-top:2px solid #e5e7eb; }
		/* Light zebra striping */
		tbody tr:nth-child(odd) td{ background:#ffffff; }
		tbody tr:nth-child(even) td{ background:#fffef7; }
	/* Subtle hover */
	tbody tr:hover td{ background:#eaf6ff; }
	/* Row enter animation */
	@keyframes rowIn{ from{ opacity:0; transform:translateY(6px);} to{ opacity:1; transform:translateY(0);} }
	tbody tr.row-anim{ animation:rowIn .5s ease both; }
		/* First column accent */
		tbody td:first-child{ font-weight:600; color:#0f172a; border-left:4px solid #93c5fd; background-image:linear-gradient(90deg,rgba(147,197,253,.15),transparent 60%); }
		/* Rotate accent colors for a light colorful feel */
		tbody tr:nth-child(2) td:first-child{ border-left-color:#a7f3d0; background-image:linear-gradient(90deg,rgba(167,243,208,.18),transparent 60%); }
		tbody tr:nth-child(3) td:first-child{ border-left-color:#fde68a; background-image:linear-gradient(90deg,rgba(253,230,138,.22),transparent 60%); }
		tbody tr:nth-child(4) td:first-child{ border-left-color:#fbcfe8; background-image:linear-gradient(90deg,rgba(251,207,232,.20),transparent 60%); }
		tbody tr:nth-child(5) td:first-child{ border-left-color:#c7d2fe; background-image:linear-gradient(90deg,rgba(199,210,254,.18),transparent 60%); }
		tbody tr:nth-child(6) td:first-child{ border-left-color:#bbf7d0; background-image:linear-gradient(90deg,rgba(187,247,208,.18),transparent 60%); }
		tbody tr:nth-child(7) td:first-child{ border-left-color:#fecaca; background-image:linear-gradient(90deg,rgba(254,202,202,.18),transparent 60%); }
		tbody tr:nth-child(8) td:first-child{ border-left-color:#bae6fd; background-image:linear-gradient(90deg,rgba(186,230,253,.18),transparent 60%); }
		tbody tr:nth-child(9) td:first-child{ border-left-color:#ddd6fe; background-image:linear-gradient(90deg,rgba(221,214,254,.18),transparent 60%); }
		tbody tr:nth-child(10) td:first-child{ border-left-color:#fcd34d; background-image:linear-gradient(90deg,rgba(252,211,77,.18),transparent 60%); }
		a.link{ color:#0ea5e9; text-decoration:none; font-weight:600; }
		a.link:hover{ text-decoration:underline; }
		.toolbar{ display:flex; gap:.6rem; justify-content:center; align-items:center; flex-wrap:wrap; }
		.btn{display:inline-flex;align-items:center;gap:.45rem;padding:.5rem .85rem;border:1px solid #d1d5db;border-radius:10px;background:#fff;color:#111;text-decoration:none;font-weight:600}
		.btn:hover{background:#f8fafc}
		.btn.active{background:#0ea5e9;color:#fff;border-color:#0284c7}
		#tabTeacher{ display:none; }
		@media (prefers-color-scheme: dark){
			body{ background:#0b1020; color:#e5e7eb; }
			header{ background:#111729; border-color:#263148; }
			table{ background:#111729; border-color:#263148; }
			thead th{ background:linear-gradient(90deg,#0f162a,#0b1426,#121a33,#0f162a); background-size:200% 100%; animation:bg-pan 12s ease-in-out infinite; border-bottom-color:#263148; }
			tbody td{ border-top-color:#1d2845; }
			tbody tr:nth-child(odd) td{ background:#111729; }
			tbody tr:nth-child(even) td{ background:#0f162a; }
			tbody tr:hover td{ background:#0c1424; }
			tbody td:first-child{ color:#e5e7eb; }
			tfoot td{ background:#0f162a; border-top-color:#263148; }
			.btn{ background:#0f162a; border-color:#263148; color:#e5e7eb; }
			.btn:hover{ background:#0c1424; }
			.btn.active{ background:#0ea5e9; color:#0b1020; border-color:#0284c7; }
		}
	</style>
	<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
	<!-- Supabase for loading the same data as datalist.html -->
	<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
	<script>
		// Build a colorful palette for the chart bars
		function makePalette(n){
			const base = [
				[14,165,233], [34,197,94], [234,179,8], [244,114,182], [99,102,241],
				[45,212,191], [251,146,60], [168,85,247], [59,130,246], [239,68,68]
			];
			const fills=[], borders=[], hovers=[];
			for(let i=0;i<n;i++){
				const [r,g,b] = base[i % base.length];
				fills.push(`rgba(${r},${g},${b},0.65)`);
				borders.push(`rgba(${r},${g},${b},1)`);
				hovers.push(`rgba(${r},${g},${b},0.85)`);
			}
			return { fills, borders, hovers };
		}
		// Create hash for datalist filtering: "Class : 6-SHAPLA-2025" -> "sclass-6-shapla-2025"
		function createClassHash(name, section, year){
			const classNum = String(name||'').toLowerCase();
			const sec = String(section||'').toLowerCase();
			const yr = String(year||'').toLowerCase();
			return `sclass-${classNum}-${sec}-${yr}`;
		}
		function slugify(s){ return 's'+String(s||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,''); }

		// --- Supabase config (same as other pages) ---
		const supabaseUrl = 'https://rtfefxghfbtirfnlbucb.supabase.co';
		const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ0ZmVmeGdoZmJ0aXJmbmxidWNiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA1MDg3OTcsImV4cCI6MjA1NjA4NDc5N30.fb7_myCmFzbV7WPNjFN_NEl4z0sOmRCefnkQbk6c10w';
		const supabase = (typeof window !== 'undefined' && window.supabase) ? window.supabase.createClient(supabaseUrl, supabaseKey) : null;
		const tableName = 'student_database';

		// Fetch all rows with pagination (1k per batch) similar to datalist.html
		async function fetchAllFromSupabase(){
			if(!supabase) throw new Error('Supabase not available');
			let all=[]; let lastId=0; let batch=0; const batchSize=1000; let prevLastId=null;
			while(true){
				batch++;
				// Include all year columns for grouping
				const cols = ['iid','class_2024','section_2024','roll_2024','class_2025','section_2025','roll_2025','class_2026','section_2026','roll_2026','status','religion','session'];
				let { data, error } = await supabase
					.from(tableName)
					.select(cols.join(','))
					.gt('iid', lastId)
					.order('iid', { ascending:true })
					.limit(batchSize);
				if(error) throw error;
				if(!data || data.length===0) break;
				for(const r of data) all.push(r);
				lastId = data[data.length-1].iid;
				if(prevLastId!==null && Number(lastId)===Number(prevLastId)) break; // plateau guard
				prevLastId = lastId;
			}
			return all;
		}

		function aggregateCounts(rows){
			// Group by class + section + session
			const map = new Map();
			for(const r of rows){
				const c = r.class_2024==null?'':String(r.class_2024);
				const s = r.section_2024==null?'':String(r.section_2024);
				const sess = r.session==null?'':String(r.session);
				const key = `${c}__${s}__${sess}`;
				if(!map.has(key)) map.set(key,{ class_:c, section:s, session:sess, total:0, tc:0, hindu:0, islam:0 });
				const g = map.get(key);
				g.total += 1;
				const statusStr = String(r.status||'').trim().toUpperCase();
				const isTC = statusStr.includes('TC');
				if(isTC) g.tc += 1;
				if(!isTC){
					const relRaw = String(r.religion||'').trim();
					const relL = relRaw.toLowerCase();
					if(/^\s*hindu\b/i.test(relRaw) || /হিন্দু/i.test(relRaw) || /হিন্দু/i.test(relL)) g.hindu += 1;
					else if(/^\s*islam\b/i.test(relRaw) || /ইসলাম/i.test(relRaw) || /ইসলাম/i.test(relL)) g.islam += 1;
				}
			}
			const arr = Array.from(map.values()).map(g=>{
				const displayName = `Class : ${g.class_}-${g.section}-${g.session||'Session'}`;
				return {
					name: displayName,
					originalName: `${g.class_}_${g.section}`,
					session: g.session || '',
					total: g.total,
					tc: g.tc,
					existing: g.total - g.tc,
					hindu: g.hindu,
					islam: g.islam,
					targetId: slugify(displayName)
				};
			});
			arr.sort((a,b)=>{
				const ax = parseInt(String(a.originalName).match(/^\s*(\d{1,2})/)?.[1]||'999',10);
				const bx = parseInt(String(b.originalName).match(/^\s*(\d{1,2})/)?.[1]||'999',10);
				if(Number.isFinite(ax)&&Number.isFinite(bx) && ax!==bx) return ax-bx;
				return String(a.originalName).localeCompare(String(b.originalName));
			});
			return arr;
		}
		
		function aggregateCountsByYear(rows, year){
			// Group by class + section + session for a specific year
			const classField = `class_${year}`;
			const sectionField = `section_${year}`;
			const map = new Map();
			console.log(`aggregateCountsByYear for year ${year}: ${rows.length} total rows`);
			let matchedRows = 0;
			for(const r of rows){
				// Skip if this year's class doesn't exist
				if(!r[classField]) continue;
				matchedRows++;
				const c = String(r[classField]);
				const s = r[sectionField]==null?'':String(r[sectionField]);
				// Skip only if class itself is TEACHER (not section)
				if(c.toUpperCase() === 'TEACHER') continue;
				const sess = r.session==null?'':String(r.session);
				const key = `${c}__${s}__${sess}`;
				console.log(`Year ${year}: Found row with class=${c}, section=${s}, session=${sess}`);
				if(!map.has(key)) map.set(key,{ class_:c, section:s, session:sess, total:0, tc:0, hindu:0, islam:0 });
				const g = map.get(key);
				g.total += 1;
				const statusStr = String(r.status||'').trim().toUpperCase();
				const isTC = statusStr.includes('TC');
				if(isTC) g.tc += 1;
				if(!isTC){
					const relRaw = String(r.religion||'').trim();
					const relL = relRaw.toLowerCase();
					if(/^\s*hindu\b/i.test(relRaw) || /হিন্দু/i.test(relRaw)) g.hindu += 1;
					else if(/^\s*islam\b/i.test(relRaw) || /ইসলাম/i.test(relRaw)) g.islam += 1;
				}
			}
			console.log(`Year ${year}: Matched ${matchedRows} rows with class_${year} field, grouped into ${map.size} groups`);
			const arr = Array.from(map.values()).map(g=>{
				const displayName = `Class : ${g.class_}-${g.section}-${year}`;
				const hash = createClassHash(g.class_, g.section, year);
				return {
					name: displayName,
					originalName: `${g.class_}_${g.section}`,
					session: g.session || '',
					total: g.total,
					tc: g.tc,
					existing: g.total - g.tc,
					hindu: g.hindu,
					islam: g.islam,
					targetId: hash
				};
			});
			arr.sort((a,b)=>{
				const ax = parseInt(String(a.originalName).match(/^\s*(\d{1,2})/)?.[1]||'999',10);
				const bx = parseInt(String(b.originalName).match(/^\s*(\d{1,2})/)?.[1]||'999',10);
				if(Number.isFinite(ax)&&Number.isFinite(bx) && ax!==bx) return ax-bx;
				return String(a.originalName).localeCompare(String(b.originalName));
			});
			return arr;
		}

		// Aggregate teacher-wise gender distribution (excluding teacher sections)
		function aggregateTeacherGender(rows){
			const map = new Map();
			for(const r of rows){
				// Get section from any available year
				let section = r.section_2024 || r.section_2025 || r.section_2026 || '';
				section = String(section).trim();
				// Skip teacher sections
				if(section.toUpperCase() === 'TEACHER') continue;
				// Determine gender based on section name (first word of section)
				let gender = 'Unknown';
				const firstWord = section.split(/[\s\-]+/)[0].toLowerCase();
				if(firstWord === 'morning') gender = 'Girl';
				else if(firstWord === 'shapla' || firstWord === 'golap') gender = 'Boy';
				if(gender === 'Unknown') continue; // Skip sections we don't recognize
				if(!map.has(gender)) map.set(gender, { gender, count: 0 });
				map.get(gender).count += 1;
			}
			return Array.from(map.values());
		}

		// Aggregate gender distribution for specific year (excluding teacher)
		function aggregateGenderByYear(rows, year){
			const classField = `class_${year}`;
			const sectionField = `section_${year}`;
			const map = new Map();
			const sectionsSeen = new Set();
			for(const r of rows){
				if(!r[classField]) continue;
				
				// Skip TC status rows
				const status = String(r.status || '').toUpperCase();
				if(status.includes('TC')) continue;
				
				const c = String(r[classField]);
				const s = r[sectionField]==null?'':String(r[sectionField]).trim();
				// Skip only if class itself is TEACHER (not section)
				if(c.toUpperCase() === 'TEACHER') continue;
				
				sectionsSeen.add(s);
				
				// Determine gender based on section name (first word of section)
				let gender = 'Unknown';
				const sectionLower = s.toLowerCase();
				// Split by space, hyphen, or other delimiters and get first word
				const parts = sectionLower.split(/[\s\-_]+/);
				const firstWord = parts[0].trim();
				
				if(firstWord === 'morning') gender = 'Girl';
				else if(firstWord === 'shapla' || firstWord === 'golap') gender = 'Boy';
				
				// Skip only if truly unknown
				if(gender === 'Unknown') continue;
				
				if(!map.has(gender)) map.set(gender, { gender, count: 0 });
				map.get(gender).count += 1;
			}
			const result = Array.from(map.values()).sort((a,b)=>{
				if(a.gender === 'Girl') return -1;
				if(b.gender === 'Girl') return 1;
				return 0;
			});
			console.log(`Year ${year} - Sections seen:`, Array.from(sectionsSeen));
			console.log(`Year ${year} - Final gender data:`, result);
			console.warn(`Gender data empty for year ${year}, genderData.length =`, result.length);
			return result;
		}

		// Aggregate religion distribution for specific year (excluding TC)
		function aggregateReligionByYear(rows, year){
			const classField = `class_${year}`;
			const map = new Map();
			for(const r of rows){
				if(!r[classField]) continue;
				
				// Skip TC status rows
				const status = String(r.status || '').toUpperCase();
				if(status.includes('TC')) continue;
				
				const c = String(r[classField]);
				// Skip only if class itself is TEACHER
				if(c.toUpperCase() === 'TEACHER') continue;
				
				// Determine religion
				const relRaw = String(r.religion||'').trim();
				const relL = relRaw.toLowerCase();
				let religion = 'Other';
				
				if(/^\s*hindu\b/i.test(relRaw) || /হিন্দু/i.test(relRaw)) religion = 'Hindu';
				else if(/^\s*islam\b/i.test(relRaw) || /ইসলাম/i.test(relRaw)) religion = 'Islam';
				
				if(religion === 'Other') continue; // Skip unknown religions
				
				if(!map.has(religion)) map.set(religion, { religion, count: 0 });
				map.get(religion).count += 1;
			}
			const result = Array.from(map.values()).sort((a,b)=>{
				if(a.religion === 'Islam') return -1;
				if(b.religion === 'Islam') return 1;
				return 0;
			});
			console.log(`Year ${year} - Religion data:`, result);
			return result;
		}

		// Aggregate religion distribution by class for specific year (excluding TC)
		function aggregateReligionByClassAndYear(rows, year){
			const classField = `class_${year}`;
			const map = new Map(); // key: "class-religion", value: {class, religion, count}
			
			for(const r of rows){
				if(!r[classField]) continue;
				
				// Skip TC status rows
				const status = String(r.status || '').toUpperCase();
				if(status.includes('TC')) continue;
				
				const c = String(r[classField]);
				// Skip only if class itself is TEACHER
				if(c.toUpperCase() === 'TEACHER') continue;
				
				// Determine religion
				const relRaw = String(r.religion||'').trim();
				let religion = 'Other';
				
				if(/^\s*hindu\b/i.test(relRaw) || /হিন্দু/i.test(relRaw)) religion = 'Hindu';
				else if(/^\s*islam\b/i.test(relRaw) || /ইসলাম/i.test(relRaw)) religion = 'Islam';
				
				// Include all religions including 'Other' (Unknown)
				const key = `${c}-${religion}`;
				if(!map.has(key)) map.set(key, { class: c, religion, count: 0 });
				map.get(key).count += 1;
			}
			
			const result = Array.from(map.values());
			// Sort by class number, then by religion (Islam first, Hindu second, Other last)
			result.sort((a, b) => {
				const classA = Number(a.class) || 999;
				const classB = Number(b.class) || 999;
				if(classA !== classB) return classA - classB;
				// Within same class, Islam first, then Hindu, then Other
				const religionOrder = { 'Islam': 0, 'Hindu': 1, 'Other': 2 };
				const orderA = religionOrder[a.religion] || 999;
				const orderB = religionOrder[b.religion] || 999;
				return orderA - orderB;
			});
			
			console.log(`Year ${year} - Religion by class data:`, result);
			return result;
		}

		// Get gender count for a specific class/section
		function getGenderCountForSection(allRows, year, className, sectionName){
			const classField = `class_${year}`;
			const sectionField = `section_${year}`;
			let boyCount = 0, girlCount = 0;
			for(const r of (allRows || [])){
				if(!r[classField]) continue;
				
				// Skip TC status rows
				const status = String(r.status || '').toUpperCase();
				if(status.includes('TC')) continue;
				
				const c = String(r[classField]);
				const s = r[sectionField]==null?'':String(r[sectionField]).trim();
				// Check if this row matches the class and section
				if(c !== className || s !== sectionName) continue;
				
				// Determine gender based on section name (first word of section)
				let gender = 'Unknown';
				const sectionLower = s.toLowerCase();
				const parts = sectionLower.split(/[\s\-_]+/);
				const firstWord = parts[0].trim();
				
				if(firstWord === 'morning') gender = 'Girl';
				else if(firstWord === 'shapla' || firstWord === 'golap') gender = 'Boy';
				
				if(gender === 'Girl') girlCount++;
				else if(gender === 'Boy') boyCount++;
			}
			return { boy: boyCount, girl: girlCount };
		}

		async function loadSheetPairs(){
			const res = await fetch('0newdatabase/sheetidname.text', { cache:'no-store' });
			if(!res.ok) throw new Error('Failed to load sheetidname.text');
			const txt = await res.text();
			const lines = txt.split(/\r?\n/).map(l=>l.trim()).filter(Boolean);
			const pairs=[]; let curId=null;
			const idRe = /^let\s+sheetId\s*=\s*['"]([^'"]+)['"];?$/i;
			const nameRe = /^let\s+sheetName\s*=\s*['"]([^'"]+)['"];?$/i;
			for(const line of lines){
				const im = idRe.exec(line); if(im){ curId = im[1]; continue; }
				const nm = nameRe.exec(line); if(nm && curId){ pairs.push({ id:curId, name:nm[1] }); curId=null; continue; }
			}
			return pairs;
		}
		
		
		async function fetchCounts({id,name}){
						try{
							const url = csvUrl(id,name);
							const results = await new Promise((resolve,reject)=>{
								Papa.parse(url,{
									download:true,
									header:true,
									skipEmptyLines:'greedy',
									dynamicTyping:false,
									complete:r=>resolve(r),
									error:e=>reject(e)
								});
							});
							const rows = (results && results.data) ? results.data : [];
							const fields = (results && results.meta && results.meta.fields) ? results.meta.fields : Object.keys(rows[0]||{});
							// TC detection (same as before)
							let tcIdx = fields.findIndex(f => String(f||'').trim().toLowerCase()==='tc');
							let tcCount = 0;
							if(tcIdx>=0){ const key = fields[tcIdx]; tcCount = rows.reduce((n,r)=> n + (String(r[key]||'').trim().toLowerCase()==='tc'?1:0), 0); }

							// Religion field detection: look for field names containing 'relig' or common misspelling 'religon'
							const religFieldName = fields.find(f=> /relig/i.test(String(f||''))) || fields.find(f=> /religon/i.test(String(f||'')));
							// If not found among fields, try keys of first row (robustness)
							let religKey = religFieldName;
							if(!religKey && rows[0]){
								religKey = Object.keys(rows[0]).find(k=> /relig/i.test(String(k||'')) || /religon/i.test(String(k||'')));
							}

							// Count hindu and islam (case-insensitive, allow Bangla words too)
							const hinduMatches = [/^\s*hindu\b/i, /হিন্দু/i];
							const islamMatches = [/^\s*islam\b/i, /ইসলাম/i];
							let hinduCount = 0, islamCount = 0;
							if(religKey){
								for(const r of rows){
									const raw = String(r[religKey]||'').trim();
									const v = raw.toLowerCase();
									if(hinduMatches.some(rx=> rx.test(raw) || rx.test(v))) hinduCount++;
									else if(islamMatches.some(rx=> rx.test(raw) || rx.test(v))) islamCount++;
								}
							}

							// Smart formatting: Convert "6_SHAPLA" to "Class : 6-SHAPLA-2025"
							const smartName = parseSmartClassName(name);
							const parts = name.split('_');
							const classNum = parts[0] || '';
							const section = parts[1] || '';
							const currentYear = new Date().getFullYear();
							const hash = createClassHash(classNum, section, currentYear);
							return { name: smartName, originalName: name, total: rows.length, tc: tcCount, existing: rows.length - tcCount, hindu: hinduCount, islam: islamCount, targetId: hash };
						}catch(err){
							const smartName = parseSmartClassName(name);
							const parts = name.split('_');
							const classNum = parts[0] || '';
							const section = parts[1] || '';
							const currentYear = new Date().getFullYear();
							const hash = createClassHash(classNum, section, currentYear);
							return { name: smartName, originalName: name, total: 0, tc: 0, existing: 0, hindu:0, islam:0, targetId: hash, error: String(err && err.message || err) };
						}
					}
		
		// Smart class name parser: "6_SHAPLA" -> "Class : 6-SHAPLA-2025"
		function parseSmartClassName(sheetName) {
			const currentYear = new Date().getFullYear(); // Get current year (2025)
			const parts = sheetName.split('_');
			if (parts.length >= 2) {
				const classNum = parts[0];
				const section = parts[1];
				return `Class : ${classNum}-${section}-${currentYear}`;
			}
			// Fallback for unexpected format
			return `Class : ${sheetName}-${currentYear}`;
		}
		function renderTable(rows, year='2025'){
			const tableHostId = `tableHost${year}`;
			const chartHostId = `chartHost${year}`;
			const canvasId = `countChart${year}`;
			const host = document.getElementById(tableHostId);
			if(!host) return;
			const status = document.getElementById('status');
			const table = document.createElement('table');
			const thead = document.createElement('thead'); const trh = document.createElement('tr');
			['Class name','Total student','TC count','Existing Student count','HINDU','ISLAM','Boy','Girl'].forEach(h=>{ const th=document.createElement('th'); th.textContent=h; trh.appendChild(th); });
			thead.appendChild(trh); table.appendChild(thead);
			const tbody = document.createElement('tbody');
			(rows||[]).forEach((r, idx)=>{
				const tr=document.createElement('tr');
				tr.classList.add('row-anim');
				tr.style.animationDelay = (idx*45)+'ms';
				const td0=document.createElement('td');
				const a=document.createElement('a'); a.href=`0newdatabase/datalist.html#${r.targetId}`; a.target='_blank'; a.rel='noopener'; a.className='link'; a.textContent=r.name; td0.appendChild(a); tr.appendChild(td0);
				;['total','tc','existing'].forEach(k=>{ const td=document.createElement('td'); const v = Number.isFinite(Number(r[k])) ? Number(r[k]) : 0; td.textContent=v; tr.appendChild(td); });
				const tdH = document.createElement('td'); tdH.textContent = (Number.isFinite(Number(r.hindu))?r.hindu:0); tr.appendChild(tdH);
				const tdI = document.createElement('td'); tdI.textContent = (Number.isFinite(Number(r.islam))?r.islam:0); tr.appendChild(tdI);
				// Get gender count for this class/section
				const genderCounts = getGenderCountForSection(window.allRows || [], year, r.originalName.split('_')[0], r.originalName.split('_')[1]);
				const tdBoy = document.createElement('td'); tdBoy.textContent = genderCounts.boy; tr.appendChild(tdBoy);
				const tdGirl = document.createElement('td'); tdGirl.textContent = genderCounts.girl; tr.appendChild(tdGirl);
				tbody.appendChild(tr);
			});
			table.appendChild(tbody);
			const totals = rows.reduce((acc,r)=>({ total:acc.total+(+r.total||0), tc:acc.tc+(+r.tc||0), existing:acc.existing+(+r.existing||0), hindu:acc.hindu+(+r.hindu||0), islam:acc.islam+(+r.islam||0) }), { total:0, tc:0, existing:0, hindu:0, islam:0 });
			// Calculate gender totals
			const genderTotals = aggregateGenderByYear(window.allRows || [], year);
			let totalBoy = 0, totalGirl = 0;
			for(const g of genderTotals){
				if(g.gender === 'Boy') totalBoy = g.count;
				else if(g.gender === 'Girl') totalGirl = g.count;
			}
			const tfoot=document.createElement('tfoot'); const trf=document.createElement('tr');
			['Total', totals.total, totals.tc, totals.existing, totals.hindu, totals.islam, totalBoy, totalGirl].forEach(v=>{ const td=document.createElement('td'); td.textContent=v; trf.appendChild(td); });
			tfoot.appendChild(trf); table.appendChild(tfoot);
			host.innerHTML=''; host.appendChild(table);
			
			// Add gender summary below table
			const genderData = aggregateGenderByYear(window.allRows || [], year);
			console.log(`Gender data for year ${year}:`, genderData);
			
			// Always show gender summary section for debugging
			const genderSummaryDiv = document.createElement('div');
			genderSummaryDiv.style.marginTop = '1.5rem';
			genderSummaryDiv.style.padding = '1rem';
			genderSummaryDiv.style.background = '#f8fafc';
			genderSummaryDiv.style.borderRadius = '8px';
			genderSummaryDiv.style.border = '1px solid #e5e7eb';
			
			const title = document.createElement('h3');
			title.textContent = 'লিঙ্গ অনুযায়ী শিক্ষার্থী (Morning = Girl | Shapla/Golap = Boy)';
			title.style.marginTop = '0';
			title.style.marginBottom = '0.75rem';
			title.style.color = '#0f172a';
			title.style.fontSize = '0.95rem';
			genderSummaryDiv.appendChild(title);
			
			if(genderData && genderData.length > 0){
				
				const genderTable = document.createElement('table');
				genderTable.style.width = '100%';
				const genderThead = document.createElement('thead');
				const genderTrh = document.createElement('tr');
				['লিঙ্গ', 'মোট শিক্ষার্থী (After TC)'].forEach(h=>{
					const th = document.createElement('th');
					th.textContent = h;
					th.style.textAlign = 'left';
					th.style.padding = '0.5rem';
					th.style.borderBottom = '1px solid #d1d5db';
					genderTrh.appendChild(th);
				});
				genderThead.appendChild(genderTrh);
				genderTable.appendChild(genderThead);
				
				const genderTbody = document.createElement('tbody');
				genderData.forEach(row=>{
					console.log('Processing gender row:', row);
					const tr = document.createElement('tr');
					const td1 = document.createElement('td');
					// Format gender label consistently (Girl, Boy)
					const formattedGender = row.gender.charAt(0).toUpperCase() + row.gender.slice(1).toLowerCase();
					console.log('Formatted gender:', formattedGender);
					td1.textContent = formattedGender;
					td1.style.padding = '0.5rem';
					const td2 = document.createElement('td');
					td2.textContent = row.count;
					td2.style.padding = '0.5rem';
					tr.appendChild(td1);
					tr.appendChild(td2);
					genderTbody.appendChild(tr);
				});
				const genderTfoot = document.createElement('tfoot');
				const genderTrf = document.createElement('tr');
				const tdGenderLabel = document.createElement('td');
				tdGenderLabel.textContent = 'মোট';
				tdGenderLabel.style.padding = '0.5rem';
				tdGenderLabel.style.fontWeight = 'bold';
				tdGenderLabel.style.borderTop = '1px solid #d1d5db';
				const tdGenderTotal = document.createElement('td');
				tdGenderTotal.textContent = genderData.reduce((sum, row)=>sum + row.count, 0);
				tdGenderTotal.style.padding = '0.5rem';
				tdGenderTotal.style.fontWeight = 'bold';
				tdGenderTotal.style.borderTop = '1px solid #d1d5db';
				genderTrf.appendChild(tdGenderLabel);
				genderTrf.appendChild(tdGenderTotal);
				genderTfoot.appendChild(genderTrf);
				genderTable.appendChild(genderTbody);
				genderTable.appendChild(genderTfoot);
				
				genderSummaryDiv.appendChild(genderTable);
			} else {
				const noDataMsg = document.createElement('p');
				noDataMsg.textContent = 'কোন লিঙ্গ ডেটা পাওয়া যায়নি।';
				noDataMsg.style.color = '#6b7280';
				noDataMsg.style.fontStyle = 'italic';
				noDataMsg.style.margin = '0';
				genderSummaryDiv.appendChild(noDataMsg);
			}
			
						host.appendChild(genderSummaryDiv);
			
			// Add religion summary below gender table (with class-wise breakdown)
			const religionDataRaw = aggregateReligionByClassAndYear(window.allRows || [], year);
			console.log(`Religion by class data for year ${year}:`, religionDataRaw);
			
			// Transform data into class-wise summary: {class: 'X', total: N, hindu: N, islam: N, unknown: N}
			const religionDataMap = new Map();
			let totalAllStudents = 0;
			let totalHindu = 0;
			let totalIslam = 0;
			let totalUnknown = 0;
			
			religionDataRaw.forEach(row => {
				if(!religionDataMap.has(row.class)){
					religionDataMap.set(row.class, { class: row.class, total: 0, hindu: 0, islam: 0, unknown: 0 });
				}
				const classData = religionDataMap.get(row.class);
				classData.total += row.count;
				totalAllStudents += row.count;
				
				if(row.religion === 'Hindu') {
					classData.hindu = row.count;
					totalHindu += row.count;
				}
				else if(row.religion === 'Islam') {
					classData.islam = row.count;
					totalIslam += row.count;
				}
				else if(row.religion === 'Other') {
					classData.unknown = row.count;
					totalUnknown += row.count;
				}
			});
			
			// Sort by class number
			const religionData = Array.from(religionDataMap.values()).sort((a, b) => {
				const classA = Number(a.class) || 999;
				const classB = Number(b.class) || 999;
				return classA - classB;
			});
			
			console.log('Transformed religion data with unknown:', religionData);
			
			const religionSummaryDiv = document.createElement('div');
			religionSummaryDiv.style.marginTop = '1.5rem';
			religionSummaryDiv.style.padding = '1rem';
			religionSummaryDiv.style.background = '#f8fafc';
			religionSummaryDiv.style.borderRadius = '8px';
			religionSummaryDiv.style.border = '1px solid #e5e7eb';
			
			const religionTitle = document.createElement('h3');
			religionTitle.textContent = 'ধর্ম অনুযায়ী শিক্ষার্থী - after TC (HINDU | ISLAM | Unknown)';
			religionTitle.style.marginTop = '0';
			religionTitle.style.marginBottom = '0.75rem';
			religionTitle.style.color = '#0f172a';
			religionTitle.style.fontSize = '0.95rem';
			religionSummaryDiv.appendChild(religionTitle);
			
			if(religionData && religionData.length > 0){
				const religionTable = document.createElement('table');
				religionTable.style.width = '100%';
				const religionThead = document.createElement('thead');
				const religionTrh = document.createElement('tr');
				['ক্লাস', 'মোট শিক্ষার্থী', 'Hindu', 'ISLAM', 'Unknown'].forEach(h=>{
					const th = document.createElement('th');
					th.textContent = h;
					th.style.textAlign = 'left';
					th.style.padding = '0.5rem';
					th.style.borderBottom = '1px solid #d1d5db';
					th.style.fontWeight = 'bold';
					religionTrh.appendChild(th);
				});
				religionThead.appendChild(religionTrh);
				religionTable.appendChild(religionThead);
				
				const religionTbody = document.createElement('tbody');
				religionData.forEach((row)=>{
					const tr = document.createElement('tr');
					
					const tdClass = document.createElement('td');
					tdClass.textContent = `Class-${row.class}`;
					tdClass.style.padding = '0.5rem';
					tdClass.style.fontWeight = 'bold';
					
					const tdTotal = document.createElement('td');
					tdTotal.textContent = row.total; // Total = Hindu + Islam
					tdTotal.style.padding = '0.5rem';
					
					const tdHindu = document.createElement('td');
					tdHindu.textContent = row.hindu;
					tdHindu.style.padding = '0.5rem';
					
					const tdIslam = document.createElement('td');
					tdIslam.textContent = row.islam;
					tdIslam.style.padding = '0.5rem';
					
					const tdUnknown = document.createElement('td');
					tdUnknown.textContent = row.unknown;
					tdUnknown.style.padding = '0.5rem';
					tdUnknown.style.color = row.unknown > 0 ? '#d97706' : '#6b7280';
					tdUnknown.style.fontWeight = row.unknown > 0 ? 'bold' : 'normal';
					
					tr.appendChild(tdClass);
					tr.appendChild(tdTotal);
					tr.appendChild(tdHindu);
					tr.appendChild(tdIslam);
					tr.appendChild(tdUnknown);
					religionTbody.appendChild(tr);
				});
				
				const religionTfoot = document.createElement('tfoot');
				const religionTrf = document.createElement('tr');
				
				const tdTotalLabel = document.createElement('td');
				tdTotalLabel.textContent = 'মোট';
				tdTotalLabel.style.padding = '0.5rem';
				tdTotalLabel.style.fontWeight = 'bold';
				tdTotalLabel.style.borderTop = '1px solid #d1d5db';
				
				const tdTotalSum = document.createElement('td');
				tdTotalSum.textContent = religionData.reduce((sum, row)=>sum + row.total, 0);
				tdTotalSum.style.padding = '0.5rem';
				tdTotalSum.style.fontWeight = 'bold';
				tdTotalSum.style.borderTop = '1px solid #d1d5db';
				
				const tdHinduSum = document.createElement('td');
				tdHinduSum.textContent = religionData.reduce((sum, row)=>sum + row.hindu, 0);
				tdHinduSum.style.padding = '0.5rem';
				tdHinduSum.style.fontWeight = 'bold';
				tdHinduSum.style.borderTop = '1px solid #d1d5db';
				
				const tdIslamSum = document.createElement('td');
				tdIslamSum.textContent = religionData.reduce((sum, row)=>sum + row.islam, 0);
				tdIslamSum.style.padding = '0.5rem';
				tdIslamSum.style.fontWeight = 'bold';
				tdIslamSum.style.borderTop = '1px solid #d1d5db';
				
				const tdUnknownSum = document.createElement('td');
				tdUnknownSum.textContent = religionData.reduce((sum, row)=>sum + row.unknown, 0);
				tdUnknownSum.style.padding = '0.5rem';
				tdUnknownSum.style.fontWeight = 'bold';
				tdUnknownSum.style.borderTop = '1px solid #d1d5db';
				tdUnknownSum.style.color = (religionData.reduce((sum, row)=>sum + row.unknown, 0) > 0) ? '#d97706' : '#6b7280';
				
				religionTrf.appendChild(tdTotalLabel);
				religionTrf.appendChild(tdTotalSum);
				religionTrf.appendChild(tdHinduSum);
				religionTrf.appendChild(tdIslamSum);
				religionTrf.appendChild(tdUnknownSum);
				religionTfoot.appendChild(religionTrf);
				
				religionTable.appendChild(religionTbody);
				religionTable.appendChild(religionTfoot);
				
				religionSummaryDiv.appendChild(religionTable);
			} else {
				const noDataMsg = document.createElement('p');
				noDataMsg.textContent = 'কোন ধর্ম ডেটা পাওয়া যায়নি।';
				noDataMsg.style.color = '#6b7280';
				noDataMsg.style.fontStyle = 'italic';
				noDataMsg.style.margin = '0';
				religionSummaryDiv.appendChild(noDataMsg);
			}
			
			host.appendChild(religionSummaryDiv);
		}

	function renderChart(rows, year='2025'){
		const chartHostId = `chartHost${year}`;
		const canvasId = `countChart${year}`;
		const wrap = document.getElementById(chartHostId);
		const canvas = document.getElementById(canvasId);
		if(!wrap || !canvas || typeof Chart === 'undefined') return;
		const labels = rows.map(r=>r.name);
		const totals = rows.map(r=>Number(r.total)||0);
		const targets = rows.map(r=>r.targetId);
		const chartKey = `__countChart${year}`;
		if(window[chartKey]){ try{ window[chartKey].destroy(); }catch(_){} }
		canvas.style.height = '340px';
		const ctx = canvas.getContext('2d');
		const pal = makePalette(totals.length);
		window[chartKey] = new Chart(ctx, {
			type:'bar',
			data:{ labels, datasets:[{ label:'Total students', data:totals, backgroundColor:pal.fills, hoverBackgroundColor:pal.hovers, borderColor:pal.borders, borderWidth:1, borderRadius:8, maxBarThickness:48 }] },
			options:{
				maintainAspectRatio:false,
				animation:{ duration:900, easing:'easeOutQuart' },
				onClick:(evt,elements)=>{
					if(elements && elements.length){ const i=elements[0].index; const target=targets[i]; if(target){ window.open('0newdatabase/datalist.html#'+target, '_blank'); } }
				},
				plugins:{ legend:{ display:false }, title:{ display:true, text:'শিক্ষার্থীদের যোগফল (সেকশনভিত্তিক)' } },
				scales:{ y:{ beginAtZero:true, title:{ display:true, text:'Total' } }, x:{ ticks:{ maxRotation:45 } } }
			}
		});
	}

	async function init(){
			const status = document.getElementById('status');
			try{
				status.textContent = 'Loading from database…';
				try{
					const allRows = await fetchAllFromSupabase();
					// Store in window for renderTable to access
					window.allRows = allRows;
					// Render all three years
					[2024, 2025, 2026].forEach(year=>{
						const yearResults = aggregateCountsByYear(allRows, year);
						renderTable(yearResults, year);
						renderChart(yearResults, year);
					});
					// Render teacher gender summary
					const genderData = aggregateTeacherGender(allRows);
					renderTeacherGenderTable(genderData);
					status.textContent = 'Loaded all years.';
				}catch(dbErr){
					console.warn('Supabase path failed, falling back to Google Sheets CSV. Error:', dbErr);
					status.textContent = 'Loading from Google Sheets…';
					const pairs = await loadSheetPairs();
					if(!pairs.length){ status.textContent='No sheets found.'; return; }
					const results = await Promise.all(pairs.map(fetchCounts));
					renderTable(results);
					renderChart(results);
					status.textContent = `Loaded ${results.length} sections.`;
				}
			}catch(err){
				console.error(err);
				status.textContent = 'Failed: '+(err && err.message || err);
			}
		}

		function switchTab(year){
			// Hide all tabs
			document.getElementById('tab2024Content').style.display = 'none';
			document.getElementById('tab2025Content').style.display = 'none';
			document.getElementById('tab2026Content').style.display = 'none';
			document.getElementById('tabTeacherContent').style.display = 'none';
			// Remove active class from all buttons
			document.getElementById('tab2024').classList.remove('active');
			document.getElementById('tab2025').classList.remove('active');
			document.getElementById('tab2026').classList.remove('active');
			document.getElementById('tabTeacher').classList.remove('active');
			// Show selected tab and mark button as active
			if(year === 'teacher'){
				document.getElementById('tabTeacherContent').style.display = 'block';
				document.getElementById('tabTeacher').classList.add('active');
			} else {
				document.getElementById(`tab${year}Content`).style.display = 'block';
				document.getElementById(`tab${year}`).classList.add('active');
			}
		}

		function renderTeacherGenderTable(genderData){
			const host = document.getElementById('teacherGenderHost');
			if(!host) return;
			const table = document.createElement('table');
			const thead = document.createElement('thead');
			const trh = document.createElement('tr');
			['লিঙ্গ', 'মোট শিক্ষার্থী'].forEach(h=>{
				const th = document.createElement('th');
				th.textContent = h;
				trh.appendChild(th);
			});
			thead.appendChild(trh);
			table.appendChild(thead);
			const tbody = document.createElement('tbody');
			genderData.forEach((row, idx)=>{
				const tr = document.createElement('tr');
				tr.classList.add('row-anim');
				tr.style.animationDelay = (idx*45)+'ms';
				const tdGender = document.createElement('td');
				// Format gender label consistently (Girl, Boy)
				const formattedGender = row.gender.charAt(0).toUpperCase() + row.gender.slice(1).toLowerCase();
				tdGender.textContent = formattedGender;
				tr.appendChild(tdGender);
				const tdCount = document.createElement('td');
				tdCount.textContent = row.count;
				tr.appendChild(tdCount);
				tbody.appendChild(tr);
			});
			table.appendChild(tbody);
			const tfoot = document.createElement('tfoot');
			const trf = document.createElement('tr');
			const tdLabel = document.createElement('td');
			tdLabel.textContent = 'মোট';
			trf.appendChild(tdLabel);
			const tdTotal = document.createElement('td');
			tdTotal.textContent = genderData.reduce((sum, row)=>sum + row.count, 0);
			trf.appendChild(tdTotal);
			tfoot.appendChild(trf);
			table.appendChild(tfoot);
			host.innerHTML = '';
			host.appendChild(table);
		}

		// Bottom summary: per-class Hindu/Islam totals
		function renderBottomSummary(rows){
			const host = document.getElementById('summaryHost');
			if(!host) return;
			const byClass = new Map();
			const bySession = new Map();
			(rows||[]).forEach(r=>{
				let cls = '';
				const m = String(r.originalName||'').match(/^\s*(\d{1,2})/);
				cls = m ? m[1] : String(r.originalName||'');
				if(!byClass.has(cls)) byClass.set(cls, { hindu:0, islam:0 });
				const agg = byClass.get(cls);
				agg.hindu += (+r.hindu||0);
				agg.islam += (+r.islam||0);
				// Session totals (use existing = total - tc)
				const sess = (r.session||'').trim() || 'Unknown';
				if(!bySession.has(sess)) bySession.set(sess, 0);
				bySession.set(sess, bySession.get(sess) + (+r.existing||0));
			});
			const items = Array.from(byClass.entries()).sort((a,b)=>{
				const ax = parseInt(a[0],10), bx = parseInt(b[0],10);
				if(Number.isFinite(ax) && Number.isFinite(bx) && ax!==bx) return ax-bx;
				return String(a[0]).localeCompare(String(b[0]));
			});
			const frag = document.createDocumentFragment();
			// Card 1: Religion totals  by Class
			const card1 = document.createElement('div');
			card1.style.cssText = 'max-width:1100px;margin:1rem auto;background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:12px;';
			const title1 = document.createElement('div');
			title1.textContent = 'Religion totals (After TC) by Class';
			title1.style.cssText = 'font-weight:700;margin-bottom:.5rem;';
			card1.appendChild(title1);
			// Two-column layout: Hindu (left), Islam (right)
			const colsWrap = document.createElement('div');
			colsWrap.style.cssText = 'display:flex;gap:16px;align-items:flex-start;justify-content:space-between;';
			const leftCol = document.createElement('div'); leftCol.style.cssText='flex:1;';
			const rightCol = document.createElement('div'); rightCol.style.cssText='flex:1;text-align:right;';
			items.forEach(([cls, sums])=>{
				// Hindu box
				const boxH = document.createElement('div');
				boxH.style.cssText = 'border:1px solid #e5e7eb;background:#fff;padding:8px 10px;border-radius:8px;margin-bottom:8px;box-shadow:0 1px 0 rgba(15,23,42,0.03);';
				boxH.textContent = `${cls}-HINDU = ${sums.hindu}`;
				leftCol.appendChild(boxH);
				// Islam box (right)
				const boxI = document.createElement('div');
				boxI.style.cssText = 'border:1px solid #e5e7eb;background:#fff;padding:8px 10px;border-radius:8px;margin-bottom:8px;box-shadow:0 1px 0 rgba(15,23,42,0.03);text-align:right;';
				boxI.textContent = `${cls}-ISLAM = ${sums.islam}`;
				rightCol.appendChild(boxI);
			});
			colsWrap.appendChild(leftCol);
			colsWrap.appendChild(rightCol);
			card1.appendChild(colsWrap);
			frag.appendChild(card1);

			// Card 2: Total students by Session (Existing), centered
			const card2 = document.createElement('div');
			card2.style.cssText = 'max-width:1100px;margin:1rem auto;background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:16px;text-align:center;';
			const title2 = document.createElement('div');
			title2.textContent = 'Total students by Session (Existing)';
			title2.style.cssText = 'font-weight:700;margin-bottom:.5rem;';
			card2.appendChild(title2);
			const sessWrap = document.createElement('div');
			sessWrap.style.cssText = 'display:flex;flex-direction:column;gap:6px;align-items:center;justify-content:center;';
			Array.from(bySession.entries()).sort((a,b)=> String(a[0]).localeCompare(String(b[0]))).forEach(([sess, total])=>{
				const line = document.createElement('div');
				line.textContent = `${sess} = ${total}`;
				sessWrap.appendChild(line);
			});
			card2.appendChild(sessWrap);
			frag.appendChild(card2);
			host.innerHTML = '';
			host.appendChild(frag);
		}
		window.addEventListener('DOMContentLoaded', init);
	</script>
</head>
<body>
	<header>
		<div class="container">
			<h1>শিক্ষার্থীদের যোগফল (সেকশনভিত্তিক)</h1>
			<div class="toolbar">
				<a class="btn" href="0newdatabase/datalist.html" target="_blank" rel="noopener">Open detailed data list</a>
				<span id="status" class="muted"></span>
			</div>
		</div>
	</header>
	<main>
		<!-- Tab buttons -->
		<div class="container" style="margin-top: 1rem;">
			<div class="toolbar" style="justify-content: center; gap: 0.5rem;">
				<button id="tab2024" class="btn" style="background: #e3f2fd; border-color: #0ea5e9;" onclick="switchTab('2024')">Class 2024</button>
				<button id="tab2025" class="btn" style="background: #e3f2fd; border-color: #0ea5e9;" onclick="switchTab('2025')">Class 2025</button>
				<button id="tab2026" class="btn" style="background: #e3f2fd; border-color: #0ea5e9;" onclick="switchTab('2026')">Class 2026</button>
				<button id="tabTeacher" class="btn" style="background: #f3e5f5; border-color: #9c27b0;" onclick="switchTab('teacher')">Teacher Summary</button>
			</div>
		</div>

		<div id="tab2024Content">
			<div class="table-wrap container" id="chartHost2024" style="background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:12px;margin-top:1rem;">
				<canvas id="countChart2024"></canvas>
			</div>
			<div class="table-wrap container" id="tableHost2024"></div>
		</div>
		<div id="tab2025Content" style="display: none;">
			<div class="table-wrap container" id="chartHost2025" style="background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:12px;margin-top:1rem;">
				<canvas id="countChart2025"></canvas>
			</div>
			<div class="table-wrap container" id="tableHost2025"></div>
		</div>
		<div id="tab2026Content" style="display: none;">
			<div class="table-wrap container" id="chartHost2026" style="background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:12px;margin-top:1rem;">
				<canvas id="countChart2026"></canvas>
			</div>
			<div class="table-wrap container" id="tableHost2026"></div>
		</div>

		<div id="tabTeacherContent" style="display: none;">
			<div class="table-wrap container" style="background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:12px;margin-top:1rem;">
				<div style="padding: 1rem; text-align: center;">
					<h2 style="margin-top: 0; color: #9c27b0;">লিঙ্গ অনুযায়ী শিক্ষার্থী বিতরণ</h2>
					<p style="color: #6b7280; margin-bottom: 1rem;">Morning = Girl | Shapla/Golap = Boy</p>
				</div>
				<div id="teacherGenderHost"></div>
			</div>
		</div>

		<div class="container" id="summaryHost" aria-label="Class-wise religion totals"></div>
	</main>
	<script>
		// Initialize on load
		document.addEventListener('DOMContentLoaded', ()=>{
			init();
			// Show default tab (2025)
			switchTab(2025);
		});
	</script>
</body>
</html>
